(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[52],{3917:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 320l512 0 0-128-512 0z" fill="#fff"/></svg>\n'},3916:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M512 320l-192 0 0 192-128 0 0-192-192 0 0-128 192 0 0-192 128 0 0 192 192 0z" fill="#fff"/></svg>\n'},3918:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M160 512l-160 0 0-160 64 0 0 96 96 0z m352-160l0 160-160 0 0-64 96 0 0-96z m-160-352l160 0 0 160-64 0 0-96-96 0z m-352 160l0-160 160 0 0 64-96 0 0 96z" fill="#fff"/></svg>\n'},3910:(a,r,l)=>{l.r(r),l.d(r,{Disclaimer:()=>c});var s=l(3893);function c(a,r){var l=a.container,c=a.runtime;l.selectAll(".igc-disclaimer").remove();var u=l.insert("div").attr("class","igc-disclaimer captiontext").text(r.text);c.height-=(0,s.outerHeight)(u.node())}},3801:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Map:()=>Map});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(498);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var parse_decimal_number__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3802);var parse_decimal_number__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(parse_decimal_number__WEBPACK_IMPORTED_MODULE_1__);var d3_selection__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(1117);var d3_interpolate__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(3832);var d3_scale__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(3876);var d3_polygon__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(3922);var d3_dispatch__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(420);var d3_array__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(3919);var d3_time_format__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(1977);var polylabel__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(548);var polylabel__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(polylabel__WEBPACK_IMPORTED_MODULE_2__);var hammerjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3803);var hammerjs__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(hammerjs__WEBPACK_IMPORTED_MODULE_3__);var moment__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(705);var moment__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);var leaflet__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3804);var leaflet__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(leaflet__WEBPACK_IMPORTED_MODULE_5__);var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3805);var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__);var proj4leaflet__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3806);var proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(proj4leaflet__WEBPACK_IMPORTED_MODULE_7__);var isbot__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2284);var bowser__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(418);var bowser__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(bowser__WEBPACK_IMPORTED_MODULE_9__);var _chart__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(3807);var _BarRace_controls__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(3872);var _controls_Controls__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(3900);var _helpers_legend__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3903);var _legend_HeatmapVertical__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3907);var _legend_Heatmap__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(3908);var _misc__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1114);var _tooltip__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(1113);var _DownloadButton__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(3909);var _Disclaimer__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(3910);var _helpers_animation__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(3911);var _elements_Hint__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(3852);var _helpers_format__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(3912);var _public_js_shared_colors__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1998);function _assert_this_initialized(a){if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _class_call_check(a,r){if(!(a instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties(a,r){for(var l=0;l<r.length;l++){var s=r[l];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,s.key,s)}}function _create_class(a,r,l){return r&&_defineProperties(a.prototype,r),l&&_defineProperties(a,l),a}function _define_property(a,r,l){return r in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l,a}function _get(a,r,l){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,r,l){var s=_super_prop_base(a,r);if(s){var c=Object.getOwnPropertyDescriptor(s,r);return c.get?c.get.call(l||a):c.value}})(a,r,l||a)}function _get_prototype_of(a){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function _inherits(a,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(r&&r.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),r&&_set_prototype_of(a,r)}function _object_spread(a){for(var r=1;r<arguments.length;r++){var l=null!=arguments[r]?arguments[r]:{};var s=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(l).filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable}))),s.forEach(function(r){_define_property(a,r,l[r])})}return a}function ownKeys(a,r){var l=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);r&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(a,r).enumerable})),l.push.apply(l,s)}return l}function _object_spread_props(a,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(r,l))}),a}function _possible_constructor_return(a,r){return r&&("object"===_type_of(r)||"function"==typeof r)?r:_assert_this_initialized(a)}function _set_prototype_of(a,r){return(_set_prototype_of=Object.setPrototypeOf||function(a,r){return a.__proto__=r,a})(a,r)}function _super_prop_base(a,r){for(;!Object.prototype.hasOwnProperty.call(a,r)&&null!==(a=_get_prototype_of(a)););return a}function _type_of(a){return a&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a}function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _create_super(a){var r=_is_native_reflect_construct();return function(){var l=_get_prototype_of(a),s;if(r){var c=_get_prototype_of(this).constructor;s=Reflect.construct(l,arguments,c)}else s=l.apply(this,arguments);return _possible_constructor_return(this,s)}}var NONDIGITCHARACTERS=["$","%","\xa3","€","<",">"];var MINHEIGHT=50;var DEFAULT_ANIMATION_LENGTH=5;var FRAMES_PER_SECOND=50;var DEFAULT_STAY_LENGTH=1;var zoomInterval;var isRobot=(0,isbot__WEBPACK_IMPORTED_MODULE_8__.default)(navigator.userAgent);function getBounds(a){return a.reduce(function(a,r){if(!r.mapItem)return a;var l=r.mapItem.getBounds();return lodash__WEBPACK_IMPORTED_MODULE_0___default().isEmpty(l)?a:a?(a._southWest.lat=Math.min(a._southWest.lat,l._southWest.lat),a._southWest.lng=Math.min(a._southWest.lng,l._southWest.lng),a._northEast.lat=Math.max(a._northEast.lat,l._northEast.lat),a._northEast.lng=Math.max(a._northEast.lng,l._northEast.lng),a):l},null)}function labelRenderer(a){var r=a.data,l=a.style;return function(a){a.styles({bottom:0,right:0,position:"absolute",textAlign:"right"}).styles(l).style("z-index",2).text(r)}}var getOpacity=function(a,r){return a?r:r/5};function attachLegendEvents(a,r){var l=a.runtime,s=a.container;var c=l.sheet;var u=c.series.points;var p=c.style.mapFeatureOpacity;var h=(0,d3_dispatch__WEBPACK_IMPORTED_MODULE_24__.default)("legendClick","highlightStart","highlightEnd");var m=!0;var b=[];h.on("highlightStart",function(r){var l=a.map;m&&(u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_25__.default)(l._container).selectAll(".leaflet-interactive").classed("__disabled",function(){return!this.classList.contains("group_"+r)&&!this.classList.contains("group_-1")}):l.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId){var l=getOpacity(r===a.feature.groupId,p);a.setStyle({fillOpacity:l})}}))}),h.on("legendClick",function(l){var c=a.map,h=a.legendData;m?(m=!1,b.push(l)):1===b.length&&b[0]===l?(m=!0,b=[]):b.includes(l)?b.splice(b.indexOf(l),1):(b.push(l),b.length===h.length&&(m=!0,b=[])),u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_25__.default)(c._container).selectAll(".leaflet-interactive").classed("__disabled",function(){var a=this;var r=!m;return b.forEach(function(l){(m||a.classList.contains("group_-1")||a.classList.contains("group_".concat(l)))&&(r=!1)}),r}):c.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId){var r=b.includes(a.feature.groupId)||m;var l=getOpacity(r,p);a.feature.properties.disabled=!r,a.setStyle({fillOpacity:l})}}),h.forEach(function(a,r){a.active=m||b.includes(r)}),r.data(h),s.selectAll(".igc-legend-ico").style("background-color",function(a){return a.active?a.color:"rgba(63, 61, 56, 0.2)"})}),h.on("highlightEnd",function(){if(m){var r=a.map;u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_25__.default)(r._container).selectAll(".leaflet-interactive").classed("__disabled",!1):r.eachLayer(function(a){var r;a.feature&&(null===(r=a.feature.properties)||void 0===r?void 0:r.groupId)!==-1&&a.setStyle({fillOpacity:p})})}}),r.addListener({id:a.chartId,dispatch:h})}var getMessage=function(a,r){if("string"==typeof r){if(a[r])return a[r];var l=Object.keys(a).find(function(a){return r.startsWith(a)});return l&&a[l]}};var attribution=function(a,r){var l={wikimedia:"Map tiles: Wikimedia Maps",stadia:'&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>\n            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>\n            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>',carto:"Map tiles by Carto, under CC BY 3.0. Data by OpenStreetMap, under ODbL.",humanitarian:'Map tiles by <a href="https://www.openstreetmap.fr/mentions-legales/">OpenStreetMap France</a>,\n            under <a href="https://creativecommons.org/licenses/by-sa/2.0/deed.fr">CC BY SA</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>,\n            under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'};var s=getMessage({"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png":l.wikimedia,"https://c.tile.stamen.com/watercolor/{z}/{x}/{y}.png":l.stadia,"https://b.tile.stamen.com/toner/{z}/{x}/{y}.png":l.stadia,"http://c.tile.stamen.com/watercolor/{z}/{x}/{y}.png":l.stadia,"http://b.tile.stamen.com/toner/{z}/{x}/{y}.png":l.stadia,"https://stamen-tiles.a.ssl.fastly.net":l.stadia,"http://a.basemaps.cartocdn.com/":l.carto,"https://cartocdn_{s}.global.ssl.fastly.net/":l.carto,"https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png":l.humanitarian,"https://tiles.stadiamaps.com/":l.stadia},a)||"Map data by OpenStreetMap, under ODbL.";return r&&(s=s?r+" | "+s:r),'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | '.concat(s)};function calculateHeightResponsive(a,r,l,s){if(!r)return a;var c,u;if(l)u=r[1][0]-r[0][0],c=r[1][1]-r[0][1];else{var p=[s.latLng(r[0][0],r[0][1]),s.latLng(r[0][0],r[1][1]),s.latLng(r[1][0],r[0][1]),s.latLng(r[1][0],r[1][1])];c=p[0].distanceTo(p[1]),(u=p[0].distanceTo(p[2]))/(c=(c+p[2].distanceTo(p[3]))/2)>5&&(u=.75*c)}return a*Math.min(u/c,1.5)}var fixMovedLocations=function(point,transformations,getBounds){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{var _loop=function(){var transformation=_step.value;var entry={lng:point.coordinates[1],lat:point.coordinates[0]};var transform=function(transformation){var safeTransform=transformation;return safeTransform=safeTransform.replace(/entry\.lat/g,"".concat(entry.lat)),safeTransform=safeTransform.replace(/entry\.long/g,"".concat(entry.lng)),safeTransform=safeTransform.replace(/[^-()\d/*+.]/g,""),eval(safeTransform)};if(getBounds(transformation.bounds).contains([entry.lng,entry.lat]))return"string"==typeof transformation.offset[0]?entry.lng=transform(transformation.offset[0]):entry.lng+=transformation.offset[0],"string"==typeof transformation.offset[1]?entry.lat=transform(transformation.offset[1]):entry.lat+=transformation.offset[1],point.coordinates=[entry.lat,entry.lng],{v:point}};for(var _iterator=transformations[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ret=_loop();if("object"===_type_of(_ret))return _ret.v}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return point};var overlaps=function(a,r){return r.some(function(r){return rectOverlap(r,a)})};var rectOverlap=function(a,r){return(lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(a.left,r.left,r.right)||lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(r.left,a.left,a.right))&&(lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(a.top,r.top,r.bottom)||lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(r.top,a.top,a.bottom))};function labelHTML(a){var r=a.labelColor,l=a.darkColor,s=a.lightColor,c=a.fontFamily;var u=(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_23__.hsl)(a.color).l<.4;var p=a.regionName.toString().replace(/</g,"&lt;");if("-"!==p){var h="font-size: ".concat(a.fontSize,"; font-style: ").concat(a.fontStyle,"; font-weight: ").concat(a.fontWeight,"; word-break: keep-all;");if(c&&(h+="font-family: ".concat(c,";")),r){var m="0 1px 0.5px ".concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px");h+="color: ".concat(r.fill,"; text-shadow: ").concat(m)}else l&&(h+="color: ".concat(u?l:s,"; text-shadow: none;"));return'<div class="igc-map-marker-label" data-index="'.concat(a.dataIndex,'" style="').concat(h,'">').concat(p,"</div>")}}var _legendData_findIndex;var groupNumber=function(a,r){var l;return null!==(_legendData_findIndex=null===(l=r)||void 0===l?void 0:l.findIndex(function(r){return r.title===a}))&&void 0!==_legendData_findIndex?_legendData_findIndex:-1};var createGetEntryStyle=function(){return function(a){var r,l,s;var c=a.color||(0,_misc__WEBPACK_IMPORTED_MODULE_16__.getColor)();var u=a.stroke||"#ffffff";var p,h,m;return{fillColor:(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_23__.rgb)(c).toString(),color:(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_23__.rgb)(u).toString(),fillRule:"nonzero",fillOpacity:null!==(p=null===(r=a)||void 0===r?void 0:r.opacity)&&void 0!==p?p:1,opacity:null!==(h=null===(l=a)||void 0===l?void 0:l.strokeOpacity)&&void 0!==h?h:1,weight:null!==(m=null===(s=a)||void 0===s?void 0:s.weight)&&void 0!==m?m:1,link:a.link,dashArray:a.dashArray,className:"group_".concat(a.groupId," ")+(a.link?"igc-chart-link":"")}}};function prepareLegendData(a){var r=a.entries,l=a.sort,s=a.groupingSymbol,c=a.decimalSeparator,u=a.colors;var p=r.map(function(a){return{color:u[a.id],title:a.label,active:!0}});return"auto"!==l&&(p=sortData(p,"descending"===l,s,c)),p.map(function(a,r){return _object_spread_props(_object_spread({},a),{groupId:r})})}function sortData(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;var c=l&&s?"".concat(l).concat(s):",.";var u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(a,function(a){return a.title});var p=!0;return u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(u,function(a){var r=Date.parse(a.title);return(!r||6>lodash__WEBPACK_IMPORTED_MODULE_0___default().get(a.title,"length"))&&(p=!1),r||a.title}),p||(u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(u,function(a){var r=a.title&&a.title.trim()||"";var l=!1;"-"===r[0]&&(l=!0,r=r.substr(1)),-1!==(r=(r=(r=(r=r.replace("&lt;","<")).replace("&gt;",">")).replace(/–/g,"-")).replace("+","")).indexOf("-")&&(r=r.split("-")[0]),-1!==NONDIGITCHARACTERS.indexOf(r[0])&&(r=r.substr(1)),-1!==NONDIGITCHARACTERS.indexOf(r.slice(-1))&&(r=r.slice(0,-1)),l&&(r="-".concat(r));var s=parse_decimal_number__WEBPACK_IMPORTED_MODULE_1___default()(r,c);return s||0===s?s:r})),r?u.reverse():u}function markerHTML(a,r,l){return'\n        <div class="map-marker-container '.concat(a.link?"igc-chart-link":"",'">\n            <svg\n                version="1.1"\n                xmlns="http://www.w3.org/2000/svg"\n                width=').concat(a.width,"\n                height=").concat(a.height,'\n                viewBox="0 0 ').concat(a.dimensions.width," ").concat(a.dimensions.height,'"\n                class="igc-map-marker"\n                style="opacity: ').concat(a.opacity,';"\n                >\n                <path fill-rule="').concat(a.fillRule,'" class="igc-table-scaledpath" fill="').concat(a.color,'" d="').concat(a.path,'"/>\n            </svg>\n            ').concat(r?labelHTML(_object_spread({},a,l)):"","\n        </div>")}function formattedValue(a,r){var l=r.tooltip.x.format(a);return"NaN"===l?a:l}function redrawHeatmap(a){var r=a.container,l=a.runtime,s=a.options;if(["left","right"].includes(lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"sheet.legend.position"))){var c=l.height;var u=r.select(".igc-legend");var p=u.select(".igc-heatmap-vertical-title-holder");var h=u.select(".igc-heatmap-scale-label-holder");var m=parseInt(lodash__WEBPACK_IMPORTED_MODULE_0___default().get(s,"style.legend.font-size"),10);var b=h.selectAll(".igc-heatmap-scale-label");var x=b.size()-1;var k=c/x;b.style("top",function(a,r){return r===x?"".concat(c-m,"px"):"".concat(r*k-m*(0===r?0:.5),"px")}),p.style("width","".concat(c,"px")),u.style("height","".concat(c,"px"))}}function createHeatmapIndexer(a){var r=a.length;return function(l){var s=0;for(var c=0;c<r;c++){var u=a[c];if(l<u)break;l>=u&&(s=c)}return s}}var Map=function(a){"use strict";_inherits(l,a);var r=_create_super(l);function l(a){var s;return _class_call_check(this,l),_define_property(_assert_this_initialized(s=r.call(this,a,"div")),"addLayerMouseEvents",function(a,r){var l=a.link,c=a.showTooltip;if(c||l){var u=_assert_this_initialized(s).tooltip;r.on({mouseover:function(){(!a.disabled||c)&&(c&&u().interaction("show"),l&&(r._map._container.style.cursor="pointer"))},mouseout:function(){c&&u().hide(),r._map._container.style.cursor=""}}),c&&r.on({mousemove:function(r){u().setText(a.text).setValue(a.displayValue).setPosition((0,_misc__WEBPACK_IMPORTED_MODULE_16__.getMousePosition)(r.originalEvent),a.color)}}),l&&r.on({click:function(){return(0,_misc__WEBPACK_IMPORTED_MODULE_16__.openUrl)(l,s.interaction)}})}}),_define_property(_assert_this_initialized(s),"getMapDimensions",function(){var a=_assert_this_initialized(s).map;var r=[];return a.eachLayer(function(a){return r.push(a)}),r.filter(function(a){return!!a.getBounds}).map(function(r){var l=r.getBounds();try{var s=a.latLngToContainerPoint(l.getNorthWest());var c=a.latLngToContainerPoint(l.getSouthEast());return{left:s.x,top:s.y,right:c.x,bottom:c.y}}catch(a){return{}}}).reduce(function(a,r){return a.left=Math.min(a.left,r.left),a.top=Math.min(a.top,r.top),a.right=Math.max(a.right,r.right),a.bottom=Math.max(a.bottom,r.bottom),a},{left:Number.MAX_VALUE,right:Number.MIN_VALUE,top:Number.MAX_VALUE,bottom:Number.MIN_VALUE})}),_define_property(_assert_this_initialized(s),"showAndHideTimelineObjects",function(){var a=function(){var a=u.data[D];if(!a.mapItem&&k.isSameOrAfter(a.start)&&!k.isSameOrAfter(a.end)){var r;var b=c?a.groupId:groupNumber(a.label,C);var x=(null===(r=C.find(function(a){return a.groupId===b}))||void 0===r?void 0:r.active)===!1;l||c||!a.feature||(a.feature.groupId=b);var S=l?leaflet__WEBPACK_IMPORTED_MODULE_5___default().marker(a.coordinates,{riseOnHover:!0,icon:leaflet__WEBPACK_IMPORTED_MODULE_5___default().divIcon({className:"map-marker group_".concat(b).concat(x?" __disabled":""),html:markerHTML(a,h,T),iconSize:[0,0]}),clickable:!0,zIndexOffset:1e3,feature:a.feature}):leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(a.feature,{style:m,smoothFactor:p});!l&&h&&!x&&a.regionName&&S.bindTooltip(labelHTML(_object_spread_props(_object_spread({},T),{regionName:a.regionName,color:a.color,dataIndex:D})),{permanent:!0,direction:"center",opacity:1}),S.addTo(L),s.addLayerMouseEvents.call(_assert_this_initialized(s),a,S),a.mapItem=S,P=!0}else if(a.mapItem&&(k.isAfter(a.end)||k.isBefore(a.start))){try{P=!0,L.removeLayer(a.mapItem),a.label&&L.removeLayer(a.label),delete a.label}catch(a){}delete a.mapItem}else a.start.isAfter(k)&&(I=!1);D++};var r=s.runtime,l=r.isPointsMode,c=r.isHeatmap,u=r.graph,p=r.smoothFactor,h=r.shouldShowLabels,m=r.getEntryStyle,b=r.isTimeline,x=r.sheet;var k=b?s.timeline.currentTime:s.runtime.startTime;var S=u.data.length;var O=_assert_this_initialized(s),C=O.legendData,T=O.labelStyle,L=O.map;var I=!0;var D=0;var P=!1;for(;I&&D<S;)a();if(!l&&h&&P&&s.updateLabels(),!l&&!x.view&&x.series.autoZoom){var z=getBounds(u.data)||x.series.map_json.view;z&&L.fitBounds(z)}}),_define_property(_assert_this_initialized(s),"pause",function(){clearInterval(s.timeline.timer),s.map.player.setPlaying(!1)}),_define_property(_assert_this_initialized(s),"play",function(){var a=s.timeline;a.timePassed>=a.duration&&(s.timeline.currentTime=s.timeline.startTime.clone(),s.timeline.timePassed=0),s.timeline.timer&&clearInterval(s.timeline.timer),s.timeline.timer=setInterval(s.cycle,20)}),_define_property(_assert_this_initialized(s),"cycle",function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var r=s.map.player;var l=s.timeline,c=l.step,u=l.duration,p=l.currentTime;a||(s.timeline.timePassed+=c,s.timeline.currentTime.add(c,"ms"),r.setValue(s.timeline.timePassed/u*100)),s.labelPlaceholder.text(s.runtime.parse(p.toDate())),s.showAndHideTimelineObjects(),s.timeline.currentTime.isSameOrAfter(s.timeline.endTime)&&s.pause()}),_define_property(_assert_this_initialized(s),"showZoomControls",function(){var a;var r=_assert_this_initialized(s).map;if(null===(a=r)||void 0===a?void 0:a.controls)for(var l in r.controls)r.controls[l]&&r.controls[l].addTo(r)}),_define_property(_assert_this_initialized(s),"removeZoomControls",function(){var a=_assert_this_initialized(s).map;if(a&&a.controls)for(var r in a.controls){var l;null===(l=a.controls[r])||void 0===l||l.remove()}}),_define_property(_assert_this_initialized(s),"setupLabelStyle",function(a){var r=a.style;var l=s.getSheetData();var c,u,p;return"manual"===lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.method")?c={fill:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.manual.fill"),stroke:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.manual.stroke")}:"contrast"===lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.method")&&(u=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.contrast.light"),p=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.contrast.dark")),{fontFamily:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"style.labels.regionNames.font-family"),fontSize:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-size","11px"),fontStyle:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-style","normal"),fontWeight:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-weight","400"),labelColor:c,darkColor:u,lightColor:p,visibility:s.runtime.isPointsMode?"visible":"hidden"}}),_define_property(_assert_this_initialized(s),"hideLabels",function(){var a=_assert_this_initialized(s).map;if(s.previousCenterLocation){var r=a.latLngToContainerPoint(s.centerOrigin);s.coordinateOffset={x:s.previousCenterLocation.x-r.x+s.coordinateOffset.x,y:s.previousCenterLocation.y-r.y+s.coordinateOffset.y}}else s.coordinateOffset={x:0,y:0};a.eachLayer(function(a){var r;var l=null===(r=a.getTooltip())||void 0===r?void 0:r._container;l&&(l.style.visibility="hidden")})}),s.events=(0,d3_dispatch__WEBPACK_IMPORTED_MODULE_24__.default)("startAnimation","endAnimation","tabChanged","downloadData","interaction","storePosition","updateViewbox"),s.interaction=s.createInteractionCaller(),s.tooltip=_tooltip__WEBPACK_IMPORTED_MODULE_17__.getTooltip,s}return _create_class(l,[{key:"interactionHint",value:function(){var a=this,r=a.chartId,l=a.options;var s;var c;this.touchDevice&&(s=280,c=this.interactivityHintText);var u=(0,_elements_Hint__WEBPACK_IMPORTED_MODULE_21__.Hint)().chartId(r).style(l.style.hint).width(s).text(c);(0,d3_selection__WEBPACK_IMPORTED_MODULE_25__.default)(l.container).call(u)}},{key:"render",value:function(){var a=this;var r=function(){zoomInterval=setInterval(function(){E.zoomOut()},300)};var l=function(){zoomInterval=setInterval(function(){E.zoomIn()},300)};var s=function(){clearInterval(zoomInterval)};var c,u,p,h,m,b;this.tooltip=(0,_tooltip__WEBPACK_IMPORTED_MODULE_17__.createStyledTooltip)(this);var x=leaflet__WEBPACK_IMPORTED_MODULE_5___default().Browser.mobile;var k=this,S=k.root,O=k.options,C=k.container,T=k.content;this.scale=(0,_misc__WEBPACK_IMPORTED_MODULE_16__.createGetScale)(S.node())().x;var L=this.getSheetData();L.formatter=(0,_helpers_format__WEBPACK_IMPORTED_MODULE_22__.formatHelper)(L);var I=L.style.mapFeatureOpacity;var D=L.series,P=D.osm,z=D.points;T.style("overflow","hidden"),T.attr("data-lookup","map-content");var M=!!O.editable;T.on("gesturestart",function(a){a.preventDefault(),a.stopPropagation()});var A=new(hammerjs__WEBPACK_IMPORTED_MODULE_3___default())(T.node());A.on("pinch",function(a){var r;a.preventDefault(),null===(r=a)||void 0===r||r.stopPropagation()}),A.on("swipe",function(a){a.preventDefault()});var E=this.map;var j;E&&(L.series.map_json=E.props.map_json,!M&&E.sheetIndex===this.sheetIndex&&E._lastCenter&&E._zoom&&E.props.autoZoom===L.series.autoZoom&&(j={center:E._lastCenter,zoom:E._zoom}),delete this.previousCenterLocation,E.eachLayer(function(a){return E.removeLayer(a)}),E.remove()),this.detectDimensions();var N=z.enabled;var V=null===(c=L.series.heatmap)||void 0===c?void 0:c.enabled;var H=null===(u=L.series.timeline)||void 0===u?void 0:u.enabled;V&&(this.heatmap=this.setupHeatmap(L)),H&&(this.timeToStay=this.setTimeToStay(L));var F=this.runtime={sheet:L,width:O.width,height:O.height,inanimate:(0,_helpers_animation__WEBPACK_IMPORTED_MODULE_20__.inanimated)(O),shouldShowLabels:L.series.showLabels,isHeatmap:V,isTimeline:H,isPointsMode:N,zoomInterval:null,smoothFactor:L.style.smoothFactor,getEntryStyle:createGetEntryStyle(),startTime:L.startTime,currentLayers:[]};var B=N?this.prepareSheetDataMarkers(L,leaflet__WEBPACK_IMPORTED_MODULE_5___default()):this.prepareSheetDataPolygons(L,leaflet__WEBPACK_IMPORTED_MODULE_5___default());if(H&&B.data.sort(function(a,r){return a.start.isSameOrAfter(r.start)?1:-1}),this.runtime.graph=B,this.runtime.shouldShowLabels&&(this.labelStyle=this.setupLabelStyle({style:O.style})),(0,_controls_Controls__WEBPACK_IMPORTED_MODULE_12__.Controls)(this,{width:O.width}),H&&B.data.length){(0,_misc__WEBPACK_IMPORTED_MODULE_16__.ensureElement)(S,"igc-label",this.groupTagName),this.labelPlaceholder=S.select(".igc-label");var R=L.startTime,U=L.endTime;var W=moment__WEBPACK_IMPORTED_MODULE_4___default().duration(U.diff(R)).asMilliseconds();var Z=R.clone();this.runtime.parse=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_26__.timeFormat)(L.series.timeline.dataOutputFormat);var G=L.series.timeline.timelineDuration||DEFAULT_ANIMATION_LENGTH;var K=W/(G*FRAMES_PER_SECOND);labelRenderer({data:this.runtime.parse(R.toDate()),layout:{marginRight:0,marginBottom:0},style:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(O,"style.axis.x.title",{})})(this.labelPlaceholder),this.timeline={timer:null,step:K,duration:W,fps:FRAMES_PER_SECOND,currentTime:Z,startTime:R,endTime:U,timePassed:0,timelineDuration:G},(0,_BarRace_controls__WEBPACK_IMPORTED_MODULE_11__.Controls)({instance:this,width:O.width,onInput:function(r){a.timeline.currentTime=a.timeline.startTime.clone(),a.timeline.timePassed=Math.round(W*r/100),a.timeline.currentTime.add(a.timeline.timePassed,"ms"),clearInterval(a.timeline.timer),a.cycle(!0)},onPlay:function(){return a.play()},onPause:function(){return a.pause()}})}else H?(0,_BarRace_controls__WEBPACK_IMPORTED_MODULE_11__.Controls)({instance:this,width:O.width}):S.selectAll(".igc-label").remove();var J={instance:this,sizeLimit:!1,attachEvents:function(){}};if(V)J.creator=function(a){var r=a.instance,l=a.layout;var s;var c=r.options,u=r.runtime,p=r.content;var h=u.sheet;var m=h.series.heatmap;var b=h.legend.position;var x=l.width,k=l.side;var S=c.style.legend;return(k?_legend_HeatmapVertical__WEBPACK_IMPORTED_MODULE_14__.HeatmapVertical:_legend_Heatmap__WEBPACK_IMPORTED_MODULE_15__.Heatmap)({target:p,instance:r,pointsMode:N,data:r.legendData,width:x,gradient:r.heatmap.gradient,maxValue:r.heatmap.maxValue,title:m.legendTitle,coldText:m.coldText,hotText:m.hotText,style:S,position:b,opacity:{active:I,disabled:getOpacity(!1,I)},layout:l.legend,showLegendValues:null===(s=h.legend)||void 0===s?void 0:s.showValues})};else{var q=(0,_helpers_legend__WEBPACK_IMPORTED_MODULE_13__.createLegendData)(this);var Y=prepareLegendData({colors:L.series.groupedColors,entries:L.legendEntries,sort:L.legend.sort,groupingSymbol:L.groupingSymbol,decimalSeparator:L.decimalSeparator});var X=!0,$=!1,Q=void 0;try{for(var ee=Y[Symbol.iterator](),et;!(X=(et=ee.next()).done);X=!0){var ea=et.value;q(ea)}}catch(a){$=!0,Q=a}finally{try{X||null==ee.return||ee.return()}finally{if($)throw Q}}this.legendData=Y,J.attachEvents=attachLegendEvents}var er=(0,_helpers_legend__WEBPACK_IMPORTED_MODULE_13__.legendHelper)(J);var eo=F.width;if(j&&(L.view=j),!O.fixedHeight){var ei=calculateHeightResponsive(eo,L.series.map_json.view,L.series.latLon,leaflet__WEBPACK_IMPORTED_MODULE_5___default());F.height=leaflet__WEBPACK_IMPORTED_MODULE_5___default().Browser.mobile?Math.min(ei,F.height):ei}if(C.selectAll(".igc-attribution").remove(),P||L.series.map_json.attribution){var en=attribution(P,L.series.map_json.attribution);C.append("div").classed("igc-attribution",!0).html(en)}if(O.fixedHeight){var el=C.select(".igc-attribution");el.node()&&(F.height-=el.node().clientHeight+parseInt(el.style("margin-top"),10)),F.height=Math.max(F.height,MINHEIGHT)}!O.fixedHeight&&(V?redrawHeatmap(this):er&&er.redraw()),S.styles({width:"".concat(F.width,"px"),height:"".concat(F.height,"px")}),this.tooltip=(0,_tooltip__WEBPACK_IMPORTED_MODULE_17__.createStyledTooltip)(this);var es=L.series.map_json.disableZoom||!1===L.series.showZoom;var ec=!es&&!M&&L.series.doubleClickZoom;var eu=L.series.latLon?leaflet__WEBPACK_IMPORTED_MODULE_5___default().CRS.Simple:leaflet__WEBPACK_IMPORTED_MODULE_5___default().CRS.EPSG3857;if(null===(h=L.series.map_json)||void 0===h?void 0:null===(p=h.crs)||void 0===p?void 0:p.name){var ed=L.series.map_json.crs;eu=new(proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default()).CRS(ed.name,ed.value,ed.options)}else L.crs&&(eu=new(proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default()).CRS(L.crs.name,L.crs.value,L.crs.options));var ev=bowser__WEBPACK_IMPORTED_MODULE_9___default().parse(window.navigator.userAgent);var ep=L.series.preferCanvas&&!("Safari"===ev.browser.name&&"iOS"===ev.os.name&&(O.height>2e3||O.width>2e3));var ef={attributionControl:!1,zoomControl:!1,crs:eu,doubleClickZoom:ec,dragging:!x&&!es&&!M,keyboard:!x&&!M,scrollWheelZoom:!1,tap:!1,touchZoom:!es&&!M,zoomDelta:L.series.zoomDelta,zoomSnap:L.series.zoomDelta/2,preferCanvas:ep,maxZoom:18};if((E=this.map=leaflet__WEBPACK_IMPORTED_MODULE_5___default().map(S.node(),ef)).sheetIndex=this.sheetIndex,E.events=this.events,E.player=this.sheetPlayer,E.labels={},E.props=L.series,E.props.isPointsMode=N,this.container.classed("igc-map-touch",x),P&&!isRobot){E._container.querySelector(".leaflet-tile-pane").style.opacity=L.style.tileLayerTransparency;var eh=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).TileLayer(P,{zIndex:0,reuseTiles:!0,crossOrigin:"strict-origin-when-cross-origin"});eh.addTo(E),eh.on("load",function(){setTimeout(function(){a.events.call("startAnimation"),setTimeout(function(){a.events.call("endAnimation")},50)},F.inanimate?0:1950)})}else if(!L.series.hideBlanks){var em=this.setupBackground(L),eg=em.separators,ey=em.background;leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(ey,{style:this.runtime.getEntryStyle,smoothFactor:this.runtime.smoothFactor}).addTo(E),eg.features.length&&leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(eg,{style:this.runtime.getEntryStyle,onEachFeature:this.addLayerMouseEvents.bind(this)}).addTo(E)}var eb;if(H||!N){if(!H&&!V){var ex=!0,ew=!1,ek=void 0;try{for(var eS=B.data[Symbol.iterator](),eO;!(ex=(eO=eS.next()).done);ex=!0){var eC=eO.value;eC.groupId=groupNumber(eC.label,this.legendData)}}catch(a){ew=!0,ek=a}finally{try{ex||null==eS.return||eS.return()}finally{if(ew)throw ek}}}B.data.length&&this.showAndHideTimelineObjects(),this.runtime.shouldShowLabels&&E.on("zoomend",function(){return a.updateLabels()}).on("zoomstart",function(){return a.hideLabels()})}else{var eT=new leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__.MarkerClusterGroup({spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,chunkedLoading:!0,maxClusterRadius:z.clusterSize,disableClusteringAtZoom:17});eb=B.data.map(function(r){var l=V?r.groupId:groupNumber(r.label,a.legendData);r.active=!0;var s=leaflet__WEBPACK_IMPORTED_MODULE_5___default().marker(r.coordinates,{riseOnHover:!0,icon:leaflet__WEBPACK_IMPORTED_MODULE_5___default().divIcon({className:"map-marker group_".concat(l),html:markerHTML(r,a.runtime.shouldShowLabels,a.labelStyle),iconSize:[0,0]}),clickable:!0,feature:r});return z.clusterSize?eT.addLayer(s):E.addLayer(s),a.addLayerMouseEvents.call(a,r,s),s}),z.clusterSize&&E.addLayer(eT),eb=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).featureGroup(eb)}var e_=L.series.autoZoom&&B.data.length&&(N?eb&&Object.keys(eb._layers).length&&eb.getBounds().pad(.05):getBounds(B.data))||L.series.map_json.view;E.defaultBounds=e_,L.view?(L.view.bounds?E.fitBounds(L.view.bounds):E.setView(L.view.center,L.view.zoom),e_=E.getBounds()):E.fitBounds(e_),E.bounds=E.getBounds(),P||E.whenReady(function(){setTimeout(function(){a.events.call("startAnimation"),setTimeout(function(){a.events.call("endAnimation")},50)},F.inanimate?0:1950)});var eL=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(O,"style.sheetSwitch.zoom");var eI=1/lodash__WEBPACK_IMPORTED_MODULE_0___default().get(O,"scale.x",1);if(E.controls={},!x&&!es){var eD=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});eD.onAdd=function(){var a=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-in");var r=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(a);r.setAttribute("data-lookup","zoom-in-button");var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-in-icon",a);var u=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(c);return u.setAttribute("data-lookup","zoom-in-icon"),r.style.background=eL.background,u.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3916).default),")"),u.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3916).default),")"),u.style.backgroundColor=eL.icon,r.style.zoom=eI,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(a).addListener(a,"mousedown",l).addListener(a,"click",function(){E.zoomIn()}).addListener(a,"mouseover",function(){r.style.background=eL.backgroundHover,u.style.backgroundColor=eL.iconHover}).addListener(a,"mouseout",function(){r.style.background=eL.background,u.style.backgroundColor=eL.icon,s()}).addListener(a,"mouseup",s),a},E.controls.zoomIn=eD,M||eD.addTo(E);var eP=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});eP.onAdd=function(){var a=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-out");var l=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(a);var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-out-icon",a);var u=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(c);return l.style.background=eL.background,u.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3917).default),")"),u.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3917).default),")"),u.style.backgroundColor=eL.icon,l.style.zoom=eI,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(a).addListener(a,"click",function(){E.zoomOut()}).addListener(a,"mouseover",function(){l.style.background=eL.backgroundHover,u.style.backgroundColor=eL.iconHover}).addListener(a,"mouseout",function(){l.style.background=eL.background,u.style.backgroundColor=eL.icon,s()}).addListener(a,"mousedown",r).addListener(a,"mouseup",s),a},E.controls.zoomOut=eP,M||eP.addTo(E);var ez=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});ez.onAdd=function(){var a=this;var r=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-restore ".concat(!x&&!M&&"__hidden"||"__upsized"));var l=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(r);var s=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-restore-icon",r);var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(s);return l.style.background=eL.background,c.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3918).default),")"),c.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(3918).default),")"),c.style.backgroundColor=eL.icon,l.style.zoom=x?1.5*eI:eI,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(r).addListener(r,"click",function(r){if(M?E.fitBounds(E.defaultBounds):E.fitBounds(E.bounds),a.viewportUnchanged=!0,!x){var l,s;r.currentTarget.classList.add("__hidden"),null===(s=ez)||void 0===s||null===(l=s.getContainer())||void 0===l||l.classList.toggle("__hidden",!0)}},r).addListener(r,"mouseover",function(){l.style.background=eL.backgroundHover,c.style.backgroundColor=eL.iconHover}).addListener(r,"mouseout",function(){l.style.background=eL.background,c.style.backgroundColor=eL.icon}),r},E.controls.restorePosition=ez,M||ez.addTo(E),this.viewportUnchanged=!0,E.on("contextmenu",s).on("drag",function(){return E.fire("moveend")}).on("movestart",function(){a.tooltip().hide()}).on("moveend",function(){try{a.viewportUnchanged=E.getBounds(!0).equals(E.bounds)}catch(r){a.viewportUnchanged=!1}if(!x){var r,l;null===(l=ez)||void 0===l||null===(r=l.getContainer())||void 0===r||r.classList.toggle("__hidden",a.viewportUnchanged)}})}(null===(b=L.series.map_json)||void 0===b?void 0:null===(m=b.meta)||void 0===m?void 0:m.disclaimer)&&(0,_Disclaimer__WEBPACK_IMPORTED_MODULE_19__.Disclaimer)(this,L.series.map_json.meta.disclaimer),(0,_DownloadButton__WEBPACK_IMPORTED_MODULE_18__.DownloadButton)(this,O.style.legend)}},{key:"updateLabels",value:function(){var a=this;setTimeout(function(){var r=a.map;a.centerOrigin=r.getCenter(),a.previousCenterLocation=r.latLngToContainerPoint(a.centerOrigin),r.eachLayer(function(l){var s;var c=null===(s=l.getTooltip())||void 0===s?void 0:s._container;if(c){var u=c.firstChild.getBoundingClientRect();c.style["margin-top"]=-(u.height/(2*a.scale))+"px",c.style["margin-left"]=-(u.width/(2*a.scale))+"px";var p=l._layers[Object.keys(l._layers)[0]]._pxBounds;var h=p&&p.max.x-p.min.x>30&&p.max.y-p.min.y>20;if(h){var m,b;var x=parseInt(c.firstChild.getAttribute("data-index"),10);var k=a.runtime.graph.data[x].feature;var S=k.geometry.coordinates;if("MultiPolygon"===k.geometry.type){var O=(0,d3_array__WEBPACK_IMPORTED_MODULE_27__.default)(S.map(function(a){return-(0,d3_polygon__WEBPACK_IMPORTED_MODULE_28__.default)(a[0])}));S=S[O]}var C=polylabel__WEBPACK_IMPORTED_MODULE_2___default()(S).reverse();var T=r.latLngToContainerPoint(C);var L;var I;c.style.left=T.x+(null!==(L=null===(m=a.coordinateOffset)||void 0===m?void 0:m.x)&&void 0!==L?L:0)+"px",c.style.top=T.y+(null!==(I=null===(b=a.coordinateOffset)||void 0===b?void 0:b.y)&&void 0!==I?I:0)+"px"}c.style.visibility=h?"visible":"hidden"}});var l=[];r.eachLayer(function(a){var r;var s=null===(r=a.getTooltip())||void 0===r?void 0:r._container;if(s&&"hidden"!==s.style.visibility){var c=s.firstChild.getBoundingClientRect();overlaps(c,l)?s.style.visibility="hidden":l.push(c)}})},50)}},{key:"defaults",value:function(){return lodash__WEBPACK_IMPORTED_MODULE_0___default().merge({},_get(_get_prototype_of(l.prototype),"defaults",this).call(this),{animation:{duration:500}})}},{key:"emptySheetData",value:function(){return lodash__WEBPACK_IMPORTED_MODULE_0___default().merge({},_get(_get_prototype_of(l.prototype),"emptySheetData",this).call(this),{legend:{enabled:!1},series:{heatmap:{enabled:!1},points:{enabled:!1},map_json:{features:[]}},style:{}})}},{key:"setupBackground",value:function(a){var r=a.series,l=r.map_json,s=r.osm;var c=l.features,u=l.meta;var p=a.style,h=p.inactive,m=p.mapFeatureOpacity,b=p.strokeWidth,x=p.strokeOpacity;var k={type:"Feature",geometry:{type:"MultiPolygon",coordinates:[]},stroke:p.strokeColor,color:h,weight:Math.min("number"==typeof b?b:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"featureStrokeWidth",s?2:1),.5),strokeOpacity:x,opacity:m,groupId:-1};var S={type:"FeatureCollection",features:[]};var O=!0,C=!1,T=void 0;try{var L=this,I=function(){var r=P.value;var l=r.geometry.coordinates;if("border"===r.properties.type){var s=L.separatorDefaultStyle(l,u,a.style.inactive);if(r.properties.dashArray&&(s.properties.dashArray=r.properties.dashArray),r.properties.strokeWidth&&(s.properties.strokeWidth=r.properties.strokeWidth),r.properties.boundFeature){var p=c.find(function(a){return a.properties.name===r.properties.boundFeature});s.properties=lodash__WEBPACK_IMPORTED_MODULE_0___default().extend({},p.properties,s.properties),delete s.properties.groupId,s.properties.type="border"}S.features.push(s)}else{var h=k.geometry.coordinates;if("Polygon"===r.geometry.type)h.push(l);else{var m=!0,b=!1,x=void 0;try{for(var O=l[Symbol.iterator](),C;!(m=(C=O.next()).done);m=!0){var T=C.value;h.push(T)}}catch(a){b=!0,x=a}finally{try{m||null==O.return||O.return()}finally{if(b)throw x}}}}};for(var D=l.features[Symbol.iterator](),P;!(O=(P=D.next()).done);O=!0)I()}catch(a){C=!0,T=a}finally{try{O||null==D.return||D.return()}finally{if(C)throw T}}return{background:k,separators:S}}},{key:"separatorDefaultStyle",value:function(a,r,l){var s,c,u,p,h,m,b,x;var k,S,O,C;return{geometry:{type:null!==(k=null===(c=r)||void 0===c?void 0:null===(s=c.border)||void 0===s?void 0:s.separatorType)&&void 0!==k?k:"MultiLineString",coordinates:[a]},properties:{hideLabel:!0,stroke:null!==(S=null===(p=r)||void 0===p?void 0:null===(u=p.border)||void 0===u?void 0:u.stroke)&&void 0!==S?S:l,weight:null!==(O=null===(m=r)||void 0===m?void 0:null===(h=m.border)||void 0===h?void 0:h.strokeWeight)&&void 0!==O?O:1.5,dashArray:null!==(C=null===(x=r)||void 0===x?void 0:null===(b=x.border)||void 0===b?void 0:b.dashArray)&&void 0!==C?C:"0",opacity:0,groupId:-1},type:"Feature"}}},{key:"setupHeatmap",value:function(a){var r=a.series.heatmap,l=r.heatmapEntries,s=r.hotColor,c=r.coldColor;var u=a.series.limits||a.defaultLimits;var p=[];var h=[];var m;var b;if(!(l>2))return this.legendData=[{text:u[0],color:c},{text:u[1],color:s}],{colors:[c,s],heatmapValues:u,gradient:!0};b=(0,d3_scale__WEBPACK_IMPORTED_MODULE_29__.default)().domain(u).range(u).ticks(l);var x=a.formatter.axis.x.createTickFormatter(b,a.axis[0]);var k=(m=b.map(function(a){return x(a)})).length;for(var S=0;S<k-1;S++)p[S]=(0,d3_interpolate__WEBPACK_IMPORTED_MODULE_30__.default)(c,s)(S/(k-2)),h[S]={text:m[S],color:p[S],groupId:S};var O=function(a){var r=createHeatmapIndexer(b);return function(l){return Math.min(a,r(l))}}(p.length-1);return this.legendData=h,{colors:p,index:O,heatmapValues:m,maxValue:m[k-1],ticks:b}}},{key:"prepareSheetDataPolygons",value:function(a){var r;var l=a.series,s=l.data,c=l.localisation,u=l.osm,p=l.map_json,h=l.groupedData;var m=a.style,b=m.colors,x=m.strokeWidth,k=m.mapFeatureOpacity,S=m.strokeOpacity;var O=a.series.heatmap,C=O.hotColor,T=O.coldColor;var L=a.tooltip;var I=this.runtime,D=I.isHeatmap,P=I.isTimeline;var z;var M=void 0!==x?x:(null!==(z=null===(r=p)||void 0===r?void 0:r.featureStrokeWidth)&&void 0!==z?z:u)?2:1;var A=this.tooltipEnabled();var E=h?"group":"title";var j=0;var N=!0,V=!1,H=void 0;try{var F=this,B=function(){var r=U.value;var l=p.features.find(function(a){return a.properties.name===r.key});if(!l||""===r.value&&D)return"continue";if(r.feature=lodash__WEBPACK_IMPORTED_MODULE_0___default().cloneDeep(l),D&&F.heatmap.gradient)r.color=r.feature.color=(0,d3_interpolate__WEBPACK_IMPORTED_MODULE_30__.default)(T,C)(r.relativeValue);else if(D){var s=F.heatmap.index(r.valueNumber);r.feature.groupId=s,r.color=r.feature.color=F.heatmap.colors[s]}else{var m=r[E];!a.series.groupedColors[m]&&(a.series.groupedColors[m]=(0,_misc__WEBPACK_IMPORTED_MODULE_16__.getColor)(j,b),j++),r.color=r.feature.color=a.series.groupedColors[m],r.feature.groupedData=h,r.feature.groupId=-1}r.displayValue=(r.value&&L.showValue?formattedValue(r.value,a.formatter)+"\n":"")+r.text,r.regionName=r.feature.regionName=c?l.properties[c]:r.label||r.title,r.label=h?r.group:c?l.properties[c]:r.label||r.title,r.groupName=!1!==L.showGroupNames?r.group:null,r.showTooltip=A,A&&(r.text=r.regionName+(r.groupName?"\n"+r.groupName:"")),r.feature.weight=M,r.feature.opacity=k,r.feature.strokeOpacity=S,r.feature.stroke=u?r.color:a.style.strokeColor,delete r.active,P&&a.series.timeline.fixedStayTime&&(r.end=r.start.clone().add(F.timeToStay))};for(var R=s[Symbol.iterator](),U;!(N=(U=R.next()).done);N=!0)B()}catch(a){V=!0,H=a}finally{try{N||null==R.return||R.return()}finally{if(V)throw H}}return{data:s,colors:b}}},{key:"prepareSheetDataMarkers",value:function(a,r){var l=this;var s;var c=this.runtime,u=c.isHeatmap,p=c.isTimeline;var h=a.series,m=h.data,b=h.osm,x=h.map_json,k=h.points,S=h.groupedData,O=h.groupedColors;var C=a.series.heatmap,T=C.hotColor,L=C.coldColor;var I=k.pointSizemin,D=k.pointSizemax,P=k.shape;var z=a.tooltip,M=a.formatter;var A=a.style,E=A.markerOpacity,j=A.colors;var N=x.corrections;var V=S?"group":"title";var H=0;return{data:Object.values(m).filter(function(a){return a.coordinates[0]&&a.coordinates[1]&&(""!==a.value||!u)}).map(function(s){!b&&N&&(s=fixMovedLocations(s,N,r.bounds));var c=u?D:Math.round(Math.max(I,D*Math.sqrt(s.relativeValue)));var h=Math.round(P.dimensions.height*c/P.dimensions.width);var m=s[V];var x;var k=-1;var C=S?s.group:s.label;if(u&&l.heatmap.gradient)x=(0,d3_interpolate__WEBPACK_IMPORTED_MODULE_30__.default)(L,T)(s.relativeValue);else if(u){var A=l.heatmap.colors;var F=A.length;var B=Math.floor(F*s.relativeValue);B>=F?B=F-1:B<0&&(B=0),x=A[B],k=B}!O[m]&&(O[m]=(0,_misc__WEBPACK_IMPORTED_MODULE_16__.getColor)(H,j),H++);var R=x||O[m];var U=l.tooltipEnabled();var W=z.showValue&&null!==s.value?formattedValue(s.value,M)+"\n":"";var Z;return U&&(Z=s.label,s.group&&!1!==z.showGroupNames&&(Z+="\n"+s.group)),p&&a.series.timeline.fixedStayTime&&(s.end=s.start.clone().add(l.timeToStay)),{color:R,coordinates:s.coordinates,dimensions:P.dimensions,groupId:k,groupName:S?s.group:"",label:C,link:s.link,name:s[V],regionName:s.label,showTooltip:U,text:Z,displayValue:W+s.text,path:P.path,height:h,opacity:E,scale:c/P.dimensions.width,verticalOffset:P.verticalOffset,width:c,start:s.start,end:s.end,fillRule:P.fillRule}}),colors:j,maxValue:null===(s=this.heatmap)||void 0===s?void 0:s.maxValue}}},{key:"setTimeToStay",value:function(a){var r=a.startTime,l=a.endTime;return moment__WEBPACK_IMPORTED_MODULE_4___default().duration(l.diff(r)).asMilliseconds()*(a.series.timeline.stayLength||DEFAULT_STAY_LENGTH)/(a.series.timeline.timelineDuration||DEFAULT_ANIMATION_LENGTH)}},{key:"applySheetOptions",value:function(a){var r=function(r){return a[r]||a[0]};a&&this.options.sheets.forEach(function(a,l){var s=r(l+1);s.axis&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.axis,s.axis),s.legend&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.legend,s.legend),s.series&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.series,s.series),s.style&&(a.style=a.style||{},lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.style,s.style)),s.tooltip&&(a.tooltip=a.tooltip||{},lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.tooltip,s.tooltip)),a.view=s.view})}}],[{key:"getClassName",value:function(){return"Map"}}]),l}(_chart__WEBPACK_IMPORTED_MODULE_10__.Chart)},3900:(a,r,l)=>{l.r(r),l.d(r,{Controls:()=>h});var s=l(3897);var c=l(3898);var u=l(3901);var p={tab:s.TabSwitcher,player:c.Player,radio:u.RadioSwitcher};function h(a){var r;var l;p[null!==(l=null===(r=a.options.sheetSwitch)||void 0===r?void 0:r.type)&&void 0!==l?l:"radio"].apply(null,arguments)}},3901:(a,r,l)=>{l.r(r),l.d(r,{RadioSwitcher:()=>x});var s=l(498);var c=l.n(s);var u=l(1117);var p=l(3902);var h=l(3898);var m=l(3892);function b(a){var r=a.insert("span").attr("class","igc-sm-sheet-switch-radio").style("visibility","hidden").style("position","absolute").style("top","0px").style("left","0px").append("div").attr("class","igc-sheets").append("div").attr("class","igc-sheet").append("span").attr("class","igc-sheet-ico").node().offsetWidth;return a.select(".igc-sm-sheet-switch-radio").remove(),r}function x(a,r){var l=a.container,s=a.options,x=a.sheetIndex;var k=s.sheets;var S=".igc-content";var O=a.interaction;if((0,h.removeSheetPlayer)(a),l.selectAll(".igc-sheets").remove(),!(0,m.sheetsEmpty)(a)){var C=c().get(s,"style.sheetSwitch.radio");var T=b(l);var L=(0,p.TextItemMetrics)().width(r.width).texts(k.map(function(a){return a.categories.title})).style(C).parentContainer(l).reservedSize(T+20)();var I=l.insert("div",S).attr("class","igc-sheets").attr("role","radiogroup").attr("aria-label","select sheet").style("width","".concat(r.width,"px"));var D=I.selectAll(".igc-sheet").data(k.map(function(a,r){return{name:a.categories.title,sheetIndex:r}}));(D=D.merge(D.enter().append("div"))).attr("class","igc-sheet").attr("role","radio").attr("aria-checked",function(a){return a.sheetIndex===x?"true":"false"}).attr("aria-labelledby",function(a){return"igc-sheet-label".concat(a.sheetIndex)}).attr("class",function(a){return a.sheetIndex===x?"igc-sheet active":"igc-sheet"}).style("max-width","".concat(L.width,"px")),D.append("span").attr("class","igc-sheet-ico").attr("role","presentation").attr("id",function(a){return"igc-sheet-".concat(a.sheetIndex)}),D.append("span").attr("class","igc-sheet-label").html(function(a){return a.name}).attr("id",function(a){return"igc-sheet-label".concat(a.sheetIndex)}).styles(C).style("height","".concat(L.label.height,"px")).style("max-width","".concat(L.label.width,"px")),D.on("click",function(r,s){var c=(0,u.default)(this);O("sheetSwitch.item","click"),a.sheetIndex!==s.sheetIndex&&(l.selectAll(".igc-sheet.active").attr("class","igc-sheet").attr("aria-checked","false"),c.classed("active",!0).attr("aria-checked","true"),a.sheetIndex=s.sheetIndex,delete a.legendData,a.render())}),(0,m.subtractHeight)(a,I.node())}}},3908:(a,r,l)=>{l.r(r),l.d(r,{Heatmap:()=>h,HeatmapEntryEvents:()=>m});var s=l(498);var c=l.n(s);var u=l(1117);var p=l(1114);function h(a){var r=a.data,l=void 0===r?[]:r,s=a.coldText,h=void 0===s?"":s,b=a.maxValue,x=void 0===b?"":b,k=a.instance,S=a.hotText,O=void 0===S?"":S,C=a.opacity,T=void 0===C?{active:1,disabled:.2}:C,L=a.showLegendValues,I=void 0===L||L,D=a.style,P=void 0===D?{}:D,z=a.layout,M=a.target,A=a.title,E=void 0===A?"":A,j=a.width,N=void 0===j?300:j,V=a.pointsMode,H=void 0!==V&&V,F=a.gradient,B=void 0!==F&&F;return function(a){var r=c().get(P,"color.label.customColor")||c().get(P,"color.label.active");var s=c().omit(z,["entry"]);a.each(function(){var a;var c=(0,u.default)(this);c.styles((0,p.kebabizeObject)(s)),c.style("width","".concat(N,"px"));var b=c.append("div").attr("class","igc-heatmap-label igc-legend-label").styles(P).style("color",r);b.append("div").attr("class","igc-heatmap-label-text").text(E);var S=I?b:c;var C=c.append("div").attr("class","igc-heatmap-entries");if(B)C.append("div").attr("class","igc-heatmap-item").styles({background:"linear-gradient(90deg, ".concat(l[0].color,", ").concat(l[1].color,")"),"pointer-events":"none"});else{var L=C.selectAll(".igc-heatmap-item").data(l);var D=L.enter().append("div").attr("class","igc-heatmap-item");D.style("background-color",function(a){return a.color}),m({g:c,entry:L=L.merge(D),instance:k,opacity:T,target:M,pointsMode:H})}if(I){var z=c.append("div").attr("class","igc-heatmap-values").styles({"line-height":null===(a=P)||void 0===a?void 0:a["font-size"],color:r});B||l.push({text:x});var A=z.selectAll(".igc-heatmap-value").data(l);var j=A.enter().append("div").attr("class","igc-heatmap-value");j.text(function(a){return a.text});var V=N/(l.length-1);var F=c.selectAll(".igc-heatmap-value");var R=[];F.each(function(){R.push((0,u.default)(this).node().scrollWidth)}),j.styles(function(a,r){var s=0===r;var c=r==l.length-1;return{display:"inline-block",width:(s||c?V/2:V)+"px","justify-content":s?"flex-start":c?"flex-end":"center"}}),j.styles(P),A=A.merge(j),S.append("div").attr("class","igc-heatmap-limit __cold").styles(P).text(h),S.append("div").attr("class","igc-heatmap-limit __hot").styles(P).text(O);var U=!1;var W=1;var Z=R.length-1;var G=R[Z];for(;!U&&W<l.length;){var K=Z%W?Z-Z%W:Z-1-(Z-1)%W;!(U=G+R[K]/2<V*(l.length-K-1))&&W++}F.classed("__hidden",function(a,r){return 0!==r&&r!==l.length-1&&1!==W&&r%W!=0}),j.style("display","flex")}})}}function m(a){var r=a.g,l=a.entry,s=a.instance,c=a.opacity,p=a.target,h=a.pointsMode;var m=c.active,b=c.disabled;var x=s.interaction;var k=l.size();var S=!0;var O=[];l.on("click",function(a,r){var l=r.groupId;var c=s.map,u=s.canvasLayer;S?(S=!1,O.push(l)):1===O.length&&O[0]===l?(S=!0,O=[]):O.includes(l)?O.splice(O.indexOf(l),1):(O.push(l),O.length===k&&(S=!0,O=[])),h?u?u.enableGroups(O):p.selectAll(".leaflet-interactive").classed("__disabled",function(){var a=this;var r=!S;return O.forEach(function(l){(S||a.classList.contains("group_".concat(l)))&&(r=!1)}),this.classList.contains("group_-1")&&(r=!1),r}):c.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type){var r=O.includes(a.feature.groupId)||S;var l=r?m:b;a.feature.disabled=!r,a.setStyle({fillOpacity:l})}}),p.selectAll(".igc-heatmap-item").classed("__disabled",function(a,r){return!(S||O.includes(r))}),x("heatmap.legend","click")}).on("mouseover",function(a,l){if(S){var c=l.groupId;var p=s.map,k=s.canvasLayer;h?k?k.enableGroups([c]):(0,u.default)(r.node().parentNode).selectAll(".leaflet-interactive").classed("__disabled",function(){return!(this.classList.contains("group_".concat(c))||this.classList.contains("group_-1"))}):p.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type){var r=c===a.feature.groupId?m:b;a.setStyle({fillOpacity:r})}})}x("heatmap.legend","hover")}).on("mouseout",function(){if(S){var a=s.map,l=s.canvasLayer;h?l?l.enableGroups([]):(0,u.default)(r.node().parentNode).selectAll(".leaflet-interactive").classed("__disabled",!1):a.eachLayer(function(a){a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type&&a.setStyle({fillOpacity:m})})}})}},3907:(a,r,l)=>{l.r(r),l.d(r,{HeatmapVertical:()=>O});var s=l(498);var c=l.n(s);var u=l(1117);var p=l(3906);var h=l(3904);var m=l(3902);var b=l(1114);var x=l(3908);function k(a,r,l){return r in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l,a}function S(a){var r=[];var l;a.each(function(){var a=(0,u.default)(this).node().getBoundingClientRect();r.push(a),l=a});var s=r[0].bottom;var c=l.top;var p=r.length;var h=!1;var m=1;for(;!h&&m<p;){var b=s;h=!0;for(var x=m;x<p-1;x+=m){if(r[x].top<b||r[x].bottom>c){m++,h=!1;break}b=r[x].bottom}}return m}function O(a){var r=a.data,l=void 0===r?[]:r,s=a.coldText,O=void 0===s?"":s,C=a.maxValue,T=void 0===C?"":C,L=a.instance,I=a.hotText,D=void 0===I?"":I,P=a.opacity,z=void 0===P?{active:1,disabled:.2}:P,M=a.position,A=void 0===M?h.LEGEND_POSITION.LEFT:M,E=a.showLegendValues,j=void 0===E||E,N=a.style,V=void 0===N?{}:N,H=a.layout,F=a.target,B=a.title,R=void 0===B?"":B,U=a.width,W=void 0===U?300:U,Z=a.gradient,G=void 0!==Z&&Z;var K=function(a){var r=a.selectAll(".igc-heatmap-scale-entry").data(l).enter().append("div").attr("class","igc-heatmap-scale-entry");return r.style("height","".concat(100/eo,"%")).style("background-color",function(a){return a.color}),(0,x.HeatmapEntryEvents)({g:(0,u.default)(r.node().parentNode),entry:r,instance:L,opacity:z,target:F}),r};var J=function(a){return a.append("div").attr("class","igc-heatmap-scale-entry").styles({height:"100%",background:"linear-gradient(180deg, ".concat(l[0].color,", ").concat(l[1].color)})};var q=function(a){if(!j)return 5;var r=a.append("div").attr("class","igc-heatmap-scale-label-holder");var s=el/eo;var c;G?c=[{text:l[0].text,offset:0},{text:l[1].text,offset:el-ei}]:(c=l.map(function(a,r){return{text:a.text,offset:r*s-ei*(0===r?0:.5)}})).push({text:T,offset:el-ei});var u=r.selectAll(".igc-heatmap-scale-label").data(c).enter().append("div").attr("class","igc-heatmap-scale-label");var h=(0,m.createMeasurement)({container:Q,lineHeight:1,style:V})(c.map(function(a){return a.text}));var b=(0,p.default)(h,function(a){return a.width});u.text(function(a){return a.text}).styles(V),u.styles({top:function(a){return"".concat(a.offset,"px")}});var x=S(u);return en&&u.classed("__right",en),u.classed("__hidden",function(a,r){return 0!==r&&r%x!=0}),b+5};var Y=function(a){if(!O&&!D)return 0;var r=a.append("div").attr("class","igc-heatmap-vertical-title-holder").style("width","".concat(el,"px"));r.classed("__right",en);var l=O&&D;var s=[D||"",O||""];en&&s.reverse();var c=0;return s.forEach(function(a,s){if(a){var u=r.append("span");u.classed("igc-heatmap-vertical-title",!0),u.classed("__top",0===s),u.classed("__bottom",1===s),u.classed("__fullsize",!l),u.styles(V),u.style("color",et),u.text(a),c=Math.max(c,u.node().offsetHeight)}}),c+=4,r.style("height","".concat(c,"px")),c};var X=function(a){return a.append("div").attr("class","igc-heatmap-vertical-slot")};var $=function(a){el=L.runtime.height;var r=c().omit(H,["entry"]);a.each(function(){var a=(0,u.default)(this);a.styles((0,b.kebabizeObject)(r)),a.style("color",et);var l=er;a.style("width","".concat(W,"px")),a.style("height","".concat(el,"px"));var s=X(a);var c=X(a);var p=X(a);var h=s;var m=p;en&&(h=p,m=s),l=Y(h)||l,h.style("width","".concat(l,"px")),c.style("width","".concat(ea,"px")),m.style("width","".concat(W-ea-l,"px")),G&&J(c)||K(c);var x=q(m);m.style("width","".concat(x,"px"));var S=l+ea+x;if(ee.width+=W-S,R){var O=a.append("div").attr("class","igc-heatmap-vertical-slot __heading").styles(V).style("color",et).text(R);O.styles(k({width:"".concat(ee.width,"px")},en?"right":"left","".concat(S,"px"))),ee.height-=O.node().offsetHeight}a.style("width","".concat(S,"px"))})};var Q=L.content,ee=L.runtime;var et=c().get(V,"color.label.customColor")||c().get(V,"color.label.active");var ea=13;var er=10;var eo=l.length;var ei=parseInt(c().get(V,"font-size"),10);var en=h.LEGEND_POSITION.RIGHT===A;var el;return $}},3902:(a,r,l)=>{l.r(r),l.d(r,{TextItemMetrics:()=>h,createMeasurement:()=>p});var s=l(3851);var c=l(1114);function u(a,r){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return a.append("span").styles(r).style("white-space","nowrap").style("line-height",l).style("visibility","hidden").style("position","absolute").style("top","0px").style("left","0px")}function p(a){var r=a.style,l=a.container,s=a.lineHeight;return function(a){var p=u(l,r,s);var h=(0,c.measureTextHtml)(a,p.node());return p.remove(),h}}function h(){var a=function(){if(m){var a=u(m,p);var s=(0,c.measureTextHtmlHeight)(r,a.node());return a.remove(),{width:l,label:{width:l-h,height:s+s/4}}}};var r=[];var l=300;var p=(0,s.chartOptions)().style.legend;var h=0;var m;var b={texts:function(l){return arguments.length?(r=l.slice(0),a):r},width:function(r){return arguments.length?(l=r,a):l},style:function(r){return arguments.length?(p=r,a):p},reservedSize:function(r){return arguments.length?(h=r,a):h},parentContainer:function(r){return arguments.length?(m=r,a):m}};return Object.assign(a,b),a}},1113:(a,r,l)=>{l.r(r),l.d(r,{createStyledTooltip:()=>b,getTooltip:()=>m,setTooltip:()=>h,tooltipDummy:()=>u});var s=l(1114);var c=l(844);var u={setText:function(){return this},setValue:function(){return this},setPosition:function(){return this},show:function(){return(0,c.logError)("Trying to show dummy tooltip"),this},interaction:function(){return this},hide:function(){return p!==u&&p.hide.apply(p,arguments),this},mute:function(){return this},unmute:function(){return this},isVisible:function(){return this},setKey:function(){return this},getKey:function(){return this}};var p=u;function h(a){p=a}function m(){return p}function b(a){var r,l,c,p,h,b,x,k,S,O,C;var T=a.createInteractionCaller();var L=null===(c=a)||void 0===c?void 0:null===(l=c.options)||void 0===l?void 0:null===(r=l.tooltip)||void 0===r?void 0:r.enabled;var I=null===(x=a)||void 0===x?void 0:null===(b=x.options)||void 0===b?void 0:null===(h=b.style)||void 0===h?void 0:null===(p=h.tooltip)||void 0===p?void 0:p.text;var D=null===(C=a)||void 0===C?void 0:null===(O=C.options)||void 0===O?void 0:null===(S=O.style)||void 0===S?void 0:null===(k=S.tooltip)||void 0===k?void 0:k.value;return function(a,r,l,s){return l?function(){return{setText:function(r){return m().setText(r,a),this},setValue:function(a){return"string"!=typeof a||m().setValue(a,r),this},setPosition:function(a,r){return m().setPosition(a,{color:r,scale:s().x}),this},interaction:function(a){return T("tooltip",a),this},show:function(){return m().show.apply(m(),arguments),this},hide:function(){return m().hide.apply(m(),arguments),this},isVisible:function(){return m().isVisible()},mute:function(){return m().mute(),this},unmute:function(){return m().unmute(),this},setKey:function(){return m().setKey.apply(m(),arguments),this},getKey:function(){return m().getKey()}}}:function(){return u}}(I=I&&(0,s.camelizeObject)(I),D=D&&(0,s.camelizeObject)(D),L,(0,s.createGetScale)(a.root.node()))}},7907:(a,r,l)=>{l.r(r),l.d(r,{default:()=>P});var s=l(498);var c=l.n(s);var u=l(3801);var p=l(2014);var h=l(7741);var m=l(1987);var b=l(7781);var x=l(7748);var k=l(7750);var S=l(751);function O(a,r,l,s,c,u,p){try{var h=a[u](p);var m=h.value}catch(a){l(a);return}h.done?r(m):Promise.resolve(m).then(s,c)}function C(a){return function(){var r=this,l=arguments;return new Promise(function(s,c){var u=a.apply(r,l);function p(a){O(u,s,c,p,h,"next",a)}function h(a){O(u,s,c,p,h,"throw",a)}p(void 0)})}}function T(a,r){var l,s,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function h(a){return function(r){return m([a,r])}}function m(u){if(l)throw TypeError("Generator is already executing.");for(;p;)try{if(l=1,s&&(c=2&u[0]?s.return:u[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,u[1])).done)return c;switch(s=0,c&&(u=[2&u[0],c.value]),u[0]){case 0:case 1:c=u;break;case 4:return p.label++,{value:u[1],done:!1};case 5:p.label++,s=u[1],u=[0];continue;case 7:u=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===u[0]||2===u[0])){p=0;continue}if(3===u[0]&&(!c||u[1]>c[0]&&u[1]<c[3])){p.label=u[1];break}if(6===u[0]&&p.label<c[1]){p.label=c[1],c=u;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(u);break}c[2]&&p.ops.pop(),p.trys.pop();continue}u=r.call(a,p)}catch(a){u=[6,a],s=0}finally{l=c=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var L=Object.assign({},h.default);var I=["edit","capture","download","thumbnail"];var D=5;L.instanceClass=u.Map,L.initialize=function(){var a=C(function(a){return T(this,function(r){switch(r.label){case 0:return[4,(0,p.loadMapData)(a.chart)];case 1:return r.sent(),[2,h.default.initialize.call(this,a)]}})});return function(r){return a.apply(this,arguments)}}(),L.setupChartOptionsDimensions=function(){var a=this,r=a.custom,l=a.chartOptions,s=a.viewMode;c().get(r,"height")&&(l.height=parseInt(r.height,10),l.fixedHeight=!0),l.editable="edit"===s},L.setupChartSheetOptionsItem=function(a){var r,l,s,u,h,O,C,T,L,P,z,M,A;var E=m.default.shapes;var j=a.heatmap,N=a.points,V=a.osm;var H=this,F=H.charts,B=H.viewMode;var R=this.custom.map_json;var U=(null===(s=this)||void 0===s?void 0:null===(l=s.charts)||void 0===l?void 0:null===(r=l.map)||void 0===r?void 0:r.labels)||{};U.regionNames&&(U.regionNames=(0,b.toKebabCase)(U.regionNames));var W=c().merge([],this.themeColors,a.colors||this.colors);var Z={};for(var G in a.groupedColors)try{Z[decodeURIComponent(G)]=a.groupedColors[G]}catch(r){Z[G]=a.groupedColors[G]}if(document)for(var K in Z)Z[K]=(0,S.replaceCssVarsInColor)(Z[K],document);if(R.corrections&&V){var J=!0,q=!1,Y=void 0;try{for(var X=R.features[Symbol.iterator](),$;!(J=($=X.next()).done);J=!0){var Q=$.value;Q.geometry.coordinatesOriginal&&(Q.geometry.coordinates=Q.geometry.coordinatesOriginal)}}catch(a){q=!0,Y=a}finally{try{J||null==X.return||X.return()}finally{if(q)throw Y}}}var ee,et,ea,er,eo,ei;var en={axis:[{},{}],legend:{align:c().get(a,"labels.legend.align",c().get(this,"charts.legend.align","top")),enabled:a.showLegend,position:c().get(a,"labels.legend.position",c().get(this,"charts.legend.position","bottom")),showValues:c().get(a,"showLegendValues",!0),sort:a.sort||"auto"},series:{heatmap:{enabled:j},points:{enabled:N},timeline:a.timeline,groupedData:a.groupedData,groupedColors:Z,map_json:R,doubleClickZoom:-1===I.indexOf(B),preferCanvas:"capture"!==B,autoZoom:a.autoZoom,hideBlanks:!N&&a.hideBlanks,latLon:a.latLon,localisation:a.localisation,osm:(0,p.getTileLayer)(a.osm,null===(h=this.charts)||void 0===h?void 0:null===(u=h.map)||void 0===u?void 0:u.osm),showZoom:a.showZoom,mobileInteractivityHint:a.mobileInteractivityHint,showLabels:a.showNames,zoomDelta:null!==(ee=null===(T=this)||void 0===T?void 0:null===(C=T.charts)||void 0===C?void 0:null===(O=C.map)||void 0===O?void 0:O.zoomDelta)&&void 0!==ee?ee:.2},style:{colors:W,inactive:a.inactive||(null===(L=F.map)||void 0===L?void 0:L.countryFill)||"#eeeeee",labels:c().merge({},U,a.labels),strokeColor:a.polygonStrokeColor||c().get(F,"map.polygonStrokeColor","#ffffff"),smoothFactor:"capture"===B?.1:.2,mapFeatureOpacity:(null!==(ea=null!==(et=a.mapFeatureOpacity)&&void 0!==et?et:R.featureOpacity)&&void 0!==ea?ea:V?50:100)/100,markerOpacity:(null!==(er=null===(P=a)||void 0===P?void 0:P.markerOpacity)&&void 0!==er?er:100)/100,strokeOpacity:(null!==(eo=null===(z=a)||void 0===z?void 0:z.strokeOpacity)&&void 0!==eo?eo:100)/100,strokeWidth:a.mapItemStrokeWidth,tileLayerTransparency:(null!==(ei=a.tileLayerTransparency)&&void 0!==ei?ei:100)/100},tooltip:{showValue:c().get(a,"showValue",!0),showGroupNames:c().get(a,"showGroupNames",c().get(F,"map.showGroupNames",!0))},view:a.view};if(j){var el,es,ec,eu;en.series.heatmap=c().merge(en.series.heatmap,{coldColor:a.coldColor||(null===(el=F.map)||void 0===el?void 0:el.coldColor)||en.style.inactive,hotColor:a.hotColor||(null===(es=F.map)||void 0===es?void 0:es.hotColor)||W[0],hotText:(null===(ec=a.hotText)||void 0===ec?void 0:ec.toString())||"",coldText:(null===(eu=a.coldText)||void 0===eu?void 0:eu.toString())||"",legendTitle:a.legendTitle,heatmapEntries:a.heatmap_entries||D}),document&&(en.series.heatmap.coldColor=(0,S.replaceCssVarsInColor)(en.series.heatmap.coldColor,document),en.series.heatmap.hotColor=(0,S.replaceCssVarsInColor)(en.series.heatmap.hotColor,document))}if(N){var ed=E[a.path]||E.circlePath;ed.verticalOffset=c().get(ed,"dimensions.stickToBottom")?-1:-.5,en.series.points=c().merge(en.series.points,{shape:ed,pointSizemax:a.pointSizemax||30,pointSizemin:c().get(a,"pointSizemin",5),clusterSize:a.clusterSize||0})}if(null===(A=en.series)||void 0===A?void 0:null===(M=A.timeline)||void 0===M?void 0:M.enabled){var ev,ep,ef,eh,em,eg,ey;var eb="%Y-%m-%d";var ex;en.series.timeline.dataInputFormat=(null===(ep=a)||void 0===ep?void 0:null===(ev=ep.dataInputFormat)||void 0===ev?void 0:ev.date)||eb,en.series.timeline.dataOutputFormat=null!==(ex=null===(ey=a)||void 0===ey?void 0:null===(eg=ey.labels)||void 0===eg?void 0:null===(em=eg.axis)||void 0===em?void 0:null===(eh=em.x)||void 0===eh?void 0:null===(ef=eh.tick)||void 0===ef?void 0:ef.timeFormat)&&void 0!==ex?ex:en.series.timeline.dataInputFormat,"auto"===en.series.timeline.dataOutputFormat&&(en.series.timeline.dataOutputFormat=en.series.timeline.dataInputFormat)}return Number.isFinite(a.xmin)&&Number.isFinite(a.xmax)&&a.xmin!==a.xmax&&(en.series.limits=[a.xmin,a.xmax]),(0,x.assignAxisTickInterval)(en,a),(0,x.assignAxisTicks)(en,a),(0,k.assignNumberFormatValues)({sheetOptions:en,custom:a,axis:[{id:"x",path:""},{id:"x1",path:"axis.x"}],inputDecimalSeparator:this.inputDecimalSeparator}),(0,k.assignNumberFormatLabels)({sheetOptions:en,custom:a,affixes:[{id:"x",path:""},{id:"label",path:""}],inputDecimalSeparator:this.inputDecimalSeparator}),en};let P=Object.freeze(L)},7748:(a,r,l)=>{l.r(r),l.d(r,{assignAxisInverse:()=>k,assignAxisLimits:()=>m,assignAxisTickInterval:()=>x,assignAxisTicks:()=>b,assignAxisTitles:()=>h,assignCategoryLabelLayout:()=>S});var s=l(498);var c=l.n(s);var u=["x","y","y2"];var p=["min","max"];function h(a,r,l){var s=!0,c=!1,p=void 0;try{for(var h=l[Symbol.iterator](),m;!(s=(m=h.next()).done);s=!0){var b=m.value;a.axis[u.indexOf(b)].title=r["".concat(b,"label")]||""}}catch(a){c=!0,p=a}finally{try{s||null==h.return||h.return()}finally{if(c)throw p}}}function m(a,r,l){var s=!0,c=!1,h=void 0;try{for(var m=l[Symbol.iterator](),b;!(s=(b=m.next()).done);s=!0){var x=b.value;var k=!0,S=!1,O=void 0;try{for(var C=p[Symbol.iterator](),T;!(k=(T=C.next()).done);k=!0){var L=T.value;var I=r["".concat(x).concat(L)];"number"==typeof I&&(a.axis[u.indexOf(x)]["".concat(L,"Limit")]=I)}}catch(a){S=!0,O=a}finally{try{k||null==C.return||C.return()}finally{if(S)throw O}}}}catch(a){c=!0,h=a}finally{try{s||null==m.return||m.return()}finally{if(c)throw h}}}function b(a,r){a.axis.forEach(function(a,l){a.ticks=c().get(r,"labels.axis.".concat(u[l],".tick.enabled"),!0)})}function x(a,r){a.axis.forEach(function(a,l){var s=c().get(r,"axis.".concat(u[l],".ticks"));void 0!==s&&(a.tickInterval=s)})}function k(a,r,l){var s=u.indexOf(l);c().set(a,"axis[".concat(s,"].invert"),c().get(r,"axis.".concat(l,".invert"),!1))}function S(a,r){"tilted"===r.categoryLayout&&c().set(a,"categories.layout","tilted")}},7750:(a,r,l)=>{l.r(r),l.d(r,{assignNumberFormatLabels:()=>b,assignNumberFormatValues:()=>m});var s=l(498);var c=l.n(s);var u=l(1991);var p={label:{libraryTargetPath:"labels.format",customAffixPath:"labels.graph.item.format.affix"},x:{libraryTargetPath:"tooltip.format.x",customAffixPath:"labels.tooltip.format.x.affix"},y:{libraryTargetPath:"tooltip.format.y",customAffixPath:"labels.tooltip.format.y.affix"},y2:{libraryTargetPath:"tooltip.format.y2",customAffixPath:"labels.tooltip.format.y2.affix"}};function h(a,r,l){var s=r.decimalSeparator,p=r.groupingSymbol;p&&c().set(a,"grouping","none"===p?"":p);var h=!1===s;c().set(a,"decimal",h?".,":s);var m=l?new u.default("firstNumber",l):new u.default(h?"legacy":"firstNumber",s);c().set(a,"numberParser",m)}function m(a){var r=a.sheetOptions,l=a.custom,s=a.axis,u=a.inputDecimalSeparator;var p={x:0,y:1,y2:2,x1:0,y1:1};s.forEach(function(a){var s=a.id,m=a.path;var b=m?c().get(l,m,{}):l;var k=r.axis[p[s]];c().has(k,"format")||c().set(k,"format",{});var S=k.format;if(x(S,b),!["x1","y1"].includes(s)){h(S,b,u);var O=["useSIPrefixes"];c().get(l,"axis.".concat(s,".affix"),!0)&&O.push("prefix","suffix"),O.forEach(function(a){var r=c().get(b,a);void 0!==r&&c().set(S,a,r)})}})}function b(a){var r=a.sheetOptions,l=a.custom,s=a.affixes,u=void 0===s?[]:s,m=a.inputDecimalSeparator;u.forEach(function(a){var s=a.id,u=a.path,b=a.ignoreCheck,k=a.defaultValue;var S=p[s];var O=S.libraryTargetPath,C=S.customAffixPath;var T=u?c().get(l,u,{}):l;var L=c().pick(T,"prefix","suffix");x(L,T),h(L,T,m),b||c().get(l,C,k)||(c().unset(L,"prefix"),c().unset(L,"suffix")),c().set(r,O,L)})}function x(a,r){var l=r.decimalPlaces,s=r.decimalPlacesValue;l&&void 0!==s&&c().set(a,"decimalPlaces",s)}},7781:(a,r,l)=>{l.r(r),l.d(r,{toKebabCase:()=>u});var s=l(498);var c=l.n(s);function u(a){return Object.keys(a).reduce(function(r,l){return r[c().kebabCase(l)]=a[l],r},{})}}}]);